(library
    (name cosmium)
    (foreign_stubs (language cxx) (include_dirs osm) (names binding))
    (foreign_archives osm)
    (c_library_flags
        (:standard -lstdc++ -lbz2 -lexpat -lz -lpthread)))

(rule
    (deps (source_tree osm))
    (targets libosm.a dllosm.so)
    (action
        (no-infer
            (progn
                (chdir osm (run make))
                (copy osm/libosmsh.so dllosm.so)
                (copy osm/libosm.a libosm.a)
))))
